{"id":"biensperience-0fdc","content_hash":"e469cd762c0ff7cccff8f89678794bcad2c9616893a5fb4667b2f68360d2dc6b","title":"Add User model session fields","description":"Add fields to User model: currentSessionId (String), sessionCreatedAt (Number, epoch), sessionExpiresAt (Number, epoch). Add method: isSessionValid(sessionId). Update schema with indexes for session lookup.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:16:35.718416-05:00","updated_at":"2025-11-01T15:30:16.784007-05:00","closed_at":"2025-11-01T15:30:16.784007-05:00","dependencies":[{"issue_id":"biensperience-0fdc","depends_on_id":"biensperience-bb27","type":"blocks","created_at":"2025-11-01T15:16:35.719991-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-2249","content_hash":"9dbc805e5618328026586246d57c60d13dce82b142d69526d10b7a72f54ca766","title":"Update documentation for session/trace IDs","description":"Create SESSION_TRACE_ID_IMPLEMENTATION.md documenting: architecture, session lifecycle, trace ID flow, frontend/backend integration, API headers, logging format, testing guide, troubleshooting. Update AGENTS.md with session/trace ID patterns.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:17:11.329207-05:00","updated_at":"2025-11-01T16:16:04.611298-05:00","closed_at":"2025-11-01T16:16:04.611298-05:00","dependencies":[{"issue_id":"biensperience-2249","depends_on_id":"biensperience-84dc","type":"blocks","created_at":"2025-11-01T15:17:11.330577-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-56bc","content_hash":"2150f013df4ec5ebce06697b6a7d743039779edf84f667556c2534726a6cbaa6","title":"Add ESLint rules for permission mutations","description":"Create ESLint rules in .eslintrc.js to prevent direct .permissions array mutations. Block: .push(), .splice(), .unshift(), .shift(), .pop(), reassignments. Allow: read-only queries, new resource initialization. Add file-level overrides for enforcer, models, controllers, tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:19:14.661067-05:00","updated_at":"2025-11-01T15:21:25.619391-05:00","closed_at":"2025-11-01T15:21:25.619391-05:00"}
{"id":"biensperience-5cbe","content_hash":"7b9cb9e0697f098f997c58d8aeed1c9ea2316be065a2ec15151fb248c2f278b3","title":"Add informational activity tracking for auth events","description":"Track user authentication events in Activity model for audit purposes:\n- Login events with IP address, user agent, timestamp\n- Logout events with IP address, timestamp\n- Failed login attempts with IP address\n- OAuth authentication events (provider, success/failure)\n- Session creation/expiration events\nAll Activity.create() calls must be asynchronous and non-blocking (use .catch() or background jobs)","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-01T16:20:15.230411-05:00","updated_at":"2025-11-01T16:20:15.230411-05:00","dependencies":[{"issue_id":"biensperience-5cbe","depends_on_id":"biensperience-f974","type":"blocks","created_at":"2025-11-01T16:20:15.232084-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-60ca","content_hash":"5d26cca85096753f76b2c274839d48808deafb089ebe7a768b939d4a18b1055f","title":"Add session/trace IDs to API responses","description":"Update controller-helpers.js successResponse() and errorResponse() to include bien-session-id and bien-trace-id in response headers. Extract from req.sessionId and req.traceId. Ensure all API responses include these headers.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:15:56.163436-05:00","updated_at":"2025-11-01T15:51:29.914795-05:00","closed_at":"2025-11-01T15:51:29.914795-05:00","dependencies":[{"issue_id":"biensperience-60ca","depends_on_id":"biensperience-bb27","type":"blocks","created_at":"2025-11-01T15:15:56.16494-05:00","created_by":"gokepelemo"},{"issue_id":"biensperience-60ca","depends_on_id":"biensperience-e4ad","type":"blocks","created_at":"2025-11-01T15:15:56.166026-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-6128","content_hash":"5f9190d0673715d4f41d5a1654b437f4699d077837500216abc93d746e1d72eb","title":"Add environment variables for session config","description":"Add SESSION_EXPIRY_HOURS to .env.example with default value of 24. Document in README. Update config to read from process.env.SESSION_EXPIRY_HOURS with fallback to 24.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:17:11.287143-05:00","updated_at":"2025-11-01T16:08:31.552936-05:00","closed_at":"2025-11-01T16:08:31.552936-05:00","dependencies":[{"issue_id":"biensperience-6128","depends_on_id":"biensperience-747e","type":"blocks","created_at":"2025-11-01T15:17:11.290557-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-6c3d","content_hash":"0b6c45d02639b689ee892d4bef69001c402ade8ada62d6f11460c3b5ec590e16","title":"Handle session ID on login/logout","description":"Update auth controllers to generate new session ID on login, expire old session ID on logout. Store session ID in User model or SessionManager with epoch timestamp. Clear session from storage on logout. Handle OAuth login flows (Facebook, Google, Twitter).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:16:35.682735-05:00","updated_at":"2025-11-01T16:07:57.795389-05:00","closed_at":"2025-11-01T16:07:57.795389-05:00","dependencies":[{"issue_id":"biensperience-6c3d","depends_on_id":"biensperience-bb27","type":"blocks","created_at":"2025-11-01T15:16:35.684289-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-747e","content_hash":"77e693762b4a97b9dcd5b4ddd2991c034c14348647cd862c6d0339158a4367e9","title":"Implement session ID and trace ID system","description":"Create a comprehensive session and trace ID system for request tracking and user session management. Session IDs (bien-session-id) bound to users with 24h default expiry, Trace IDs (bien-trace-id) for per-request tracking across microservices. Frontend generation with backend validation using epoch time.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:13:37.061486-05:00","updated_at":"2025-11-01T16:16:08.662607-05:00","closed_at":"2025-11-01T16:16:08.662607-05:00"}
{"id":"biensperience-79e6","content_hash":"c4fc745b15ab816a738f66e3f22e72804fdc0e66bcee4fc14e92ffeabd94ab2b","title":"Create monitoring dashboard for Activity logs","description":"Build super admin monitoring dashboard for Activity logs. Features: filtering (by action, resource, actor, date range), search, pagination, rollback UI. Add to Profile menu (super admin only). Create ActivityMonitor.jsx component. Add GET /api/activities endpoint with filters. Implement Activity.restoreState() UI for one-click rollback.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-01T15:20:07.765464-05:00","updated_at":"2025-11-01T15:20:07.765464-05:00"}
{"id":"biensperience-84dc","content_hash":"e496f7d20ad2455cad4399cab67c1a01949e933813954724110362cc1aa7ba23","title":"Create tests for session/trace ID system","description":"Create comprehensive test suite: session generation/expiry/refresh, trace ID generation, middleware validation, logger integration, API response headers. Test OAuth flows, concurrent sessions, expired sessions, missing headers.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:16:35.753795-05:00","updated_at":"2025-11-01T16:11:31.229324-05:00","closed_at":"2025-11-01T16:11:31.229324-05:00","dependencies":[{"issue_id":"biensperience-84dc","depends_on_id":"biensperience-fb36","type":"blocks","created_at":"2025-11-01T15:16:35.75536-05:00","created_by":"gokepelemo"},{"issue_id":"biensperience-84dc","depends_on_id":"biensperience-8fab","type":"blocks","created_at":"2025-11-01T15:16:35.756423-05:00","created_by":"gokepelemo"},{"issue_id":"biensperience-84dc","depends_on_id":"biensperience-60ca","type":"blocks","created_at":"2025-11-01T15:16:35.757391-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-8fab","content_hash":"9afbf94c1a4fdc9e76ce940d23d4e8311cd64d7f9828d388ee4033886fc21197","title":"Add session/trace IDs to sendRequest utility","description":"Update src/utilities/send-request.js to include bien-session-id and bien-trace-id headers in all API requests. Get session ID from getSessionId(), generate new trace ID for each request using generateTraceId(). Handle session expiry and refresh.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:15:56.128829-05:00","updated_at":"2025-11-01T15:51:29.874518-05:00","closed_at":"2025-11-01T15:51:29.874518-05:00","dependencies":[{"issue_id":"biensperience-8fab","depends_on_id":"biensperience-c0af","type":"blocks","created_at":"2025-11-01T15:15:56.130245-05:00","created_by":"gokepelemo"},{"issue_id":"biensperience-8fab","depends_on_id":"biensperience-9a49","type":"blocks","created_at":"2025-11-01T15:15:56.131267-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-9a49","content_hash":"6df3bc57d4f79d923783bdb7186619eb4f20b13222ceeb863244629a55de5afb","title":"Create trace ID utility functions (frontend)","description":"Implement utility functions for generating trace IDs on frontend: generateTraceId(), getTraceId(). Use crypto.randomUUID() for generation. Create new trace ID for each API request. Store temporarily during request lifecycle.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:15:08.412739-05:00","updated_at":"2025-11-01T15:25:28.731122-05:00","closed_at":"2025-11-01T15:25:28.731122-05:00","dependencies":[{"issue_id":"biensperience-9a49","depends_on_id":"biensperience-747e","type":"blocks","created_at":"2025-11-01T15:15:08.41447-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-ab67","content_hash":"1c49bc31185720b3336749e8d3cf14f9510218a95091187152c526285d113ed9","title":"Complete permissions security audit and verification","description":"Comprehensive security audit of permission-enforcer system as requested by user.\n\nUser Requirements:\n1. Pressure test the permissions-enforcer system\n2. Make it the ONLY way permissions are enforced/confirmed/audited\n3. Full stack trace of all functions that modify permissions array\n4. Permissions untouchable except via enforcer\n5. Auditable with strictest modern security standards\n\nWork Completed:\n1. Verified all controllers use PermissionEnforcer exclusively (4/4 controllers)\n2. Confirmed ESLint rules block direct mutations (6 rules in .eslintrc.js)\n3. Verified Activity model logs all changes (30+ action types)\n4. Confirmed atomic MongoDB operations prevent race conditions\n5. Fixed 2 test issues (race condition test, high load timeout)\n6. Created comprehensive documentation\n\nFiles Created:\n- documentation/PERMISSIONS_SECURITY_VERIFICATION.md (430+ lines)\n- documentation/PERMISSIONS_SECURITY_SUMMARY.md (quick reference)\n\nFiles Modified:\n- tests/api/permission-enforcer-security.test.js (fixed race condition + timeout)\n\nTest Results:\n- 24/25 security tests passing (96%)\n- 188/201 total tests passing (93.5%)\n- Race condition protection: ✅\n- Concurrent operations: ✅\n- Audit logging: ✅\n\nSecurity Controls Verified:\n1. Authorization (owner/super admin checks)\n2. Validation (schema + business rules)\n3. Audit trail (immutable activity logs)\n4. Atomicity (race condition prevention)\n5. Non-repudiation (actor tracking)\n6. Rollback capability\n7. Defense in depth (ESLint + runtime + DB)\n8. Least privilege (role-based access)\n9. Separation of duties\n10. Comprehensive logging\n\nStatus: Production ready, all requirements met","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-01T16:40:55.522078-05:00","updated_at":"2025-11-01T16:41:54.361987-05:00","closed_at":"2025-11-01T16:41:54.361987-05:00","labels":["completed","permissions","security"]}
{"id":"biensperience-addd","content_hash":"0ccb3db985ad7e6a95aa99b7acd49cf98af19bd521962a40d3ac67f801c82433","title":"Hide unconfigured OAuth login buttons","description":"If an OAuth login method is not completely configured, don't display the button on the login/signup flow. Implementation requirements:\n- Check OAuth environment variables on backend startup\n- Create endpoint to return available OAuth providers: GET /api/auth/available-providers\n- Frontend checks available providers before rendering OAuth buttons\n- Hide Facebook login if FACEBOOK_APP_ID or FACEBOOK_APP_SECRET missing\n- Hide Google login if GOOGLE_CLIENT_ID or GOOGLE_CLIENT_SECRET missing\n- Hide Twitter login if TWITTER_CLIENT_ID or TWITTER_CLIENT_SECRET missing\n- Update SignUpForm and login components to conditionally render buttons\n- Add graceful fallback if no OAuth providers configured","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-11-01T16:20:40.273704-05:00","updated_at":"2025-11-01T17:20:46.145335-05:00"}
{"id":"biensperience-b89c","content_hash":"e7b188e7c0eb00f9a4508e77e0de710fca6758e864231686dce9330a4e7fd138","title":"Document bd (Beads) integration in CLAUDE.md and AGENTS.md","description":"Comprehensive documentation for using bd CLI tool for task management, issue tracking, and context storage as the codebase grows.\n\nFiles modified:\n- CLAUDE.md: Added extensive bd integration section (320+ lines)\n- AGENTS.md: Added bd usage guide for agents (310+ lines)\n- documentation/BEADS_ORGANIZATIONAL_GUIDE.md: Created comprehensive guide (1300+ lines)\n\nKey sections:\n1. Why use bd over TodoWrite\n2. Task management workflow\n3. Context storage best practices\n4. Documentation strategy (bd for WIP, .md for architecture)\n5. Agent workflow integration\n6. Common commands reference\n7. Pro tips and migration guide\n8. Git integration and commit alignment\n9. Organizational strategies for growing codebases\n10. Labeling, dependencies, epics, priorities\n11. Search/filtering, team collaboration\n12. Maintenance and advanced workflows\n\nBenefits:\n- Persistent task database (survives session restarts)\n- Dependency-aware task tracking\n- Rich context storage with full history\n- Git commit integration for traceability\n- Powerful search and filtering\n- Team collaboration features\n\nStatus: Complete","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T16:39:35.463071-05:00","updated_at":"2025-11-01T16:40:55.47587-05:00","closed_at":"2025-11-01T16:40:55.47587-05:00","labels":["beads","completed","docs"]}
{"id":"biensperience-bb27","content_hash":"53f133c462eaca147f7fc28e6b25ae2d6f9556aabdb324ec23ea176693320084","title":"Create session ID middleware (backend)","description":"Implement Express middleware to validate session IDs: validateSessionId(), checkSessionExpiry(), bindSessionToUser(). Verify session ID exists, not expired, and bound to authenticated user. Return 401 if invalid/expired. Store session metadata in User model or separate SessionManager.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:15:08.446685-05:00","updated_at":"2025-11-01T15:38:15.439601-05:00","closed_at":"2025-11-01T15:38:15.439601-05:00","dependencies":[{"issue_id":"biensperience-bb27","depends_on_id":"biensperience-c0af","type":"blocks","created_at":"2025-11-01T15:15:08.448174-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-c0af","content_hash":"778206eca8db20641b9664993db25f5df18d83f43513af3aa00af1e580a83a26","title":"Create session ID utility functions (frontend)","description":"Implement utility functions for generating and managing session IDs on frontend: generateSessionId(), getSessionId(), isSessionExpired(), refreshSessionIfNeeded(). Use crypto.randomUUID() for generation. Store in localStorage with epoch timestamp. Default 24h expiry (configurable via SESSION_EXPIRY_HOURS env var).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:14:37.837023-05:00","updated_at":"2025-11-01T15:25:28.695145-05:00","closed_at":"2025-11-01T15:25:28.695145-05:00","dependencies":[{"issue_id":"biensperience-c0af","depends_on_id":"biensperience-747e","type":"blocks","created_at":"2025-11-01T15:14:37.839341-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-e4ad","content_hash":"dd52edfd30516753a676c49a2028c39618eb0533e5a4a2be25058e7c79be4bdf","title":"Create trace ID middleware (backend)","description":"Implement Express middleware to extract and validate trace IDs: extractTraceId(), attachTraceToRequest(). Extract bien-trace-id from headers, attach to req.traceId for use in logging. Generate new trace ID if missing (for backward compatibility).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:15:08.47938-05:00","updated_at":"2025-11-01T15:38:15.489785-05:00","closed_at":"2025-11-01T15:38:15.489785-05:00","dependencies":[{"issue_id":"biensperience-e4ad","depends_on_id":"biensperience-747e","type":"blocks","created_at":"2025-11-01T15:15:08.480878-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-e853","content_hash":"039656c35ffd8ec32eadfac29242ee541faac92b0d827a2aba4e3d17f38bc418","title":"Evaluate schema immutability for permissions","description":"Evaluate adding immutable: true to permissions arrays in all models (Experience, Destination, Photo, Plan, User). Document decision in SCHEMA_IMMUTABILITY_DECISION.md. Consider: technical immutability vs policy-based approach, impact on enforcer atomic operations, developer experience.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:19:40.730418-05:00","updated_at":"2025-11-01T15:21:53.016749-05:00","closed_at":"2025-11-01T15:21:53.016749-05:00"}
{"id":"biensperience-eee5","content_hash":"051824501c925f0707de197baa33ed45bf08e50ebfc75b3d6d9c00fd4a3cd8d0","title":"Fix remaining 13 test failures (non-security-critical)","description":"Fix remaining test failures identified during permissions audit.\n\nCurrent Status: 188/201 tests passing (93.5%)\n\nFailing Tests (13 total):\n\n1. Session/Trace System Tests (12 failures):\n   - Issue: testUser.generateToken is not a function\n   - File: tests/api/session-trace-system.test.js\n   - Root cause: Missing generateToken method in User model or incorrect test setup\n   - Fix: Add generateToken() method or update test setup\n\n2. Super Admin Plan Access Test (1 failure):\n   - Issue: Test isolation problem\n   - File: tests/api/super-admin-permissions.test.js\n   - Root cause: Test interference or database state issues\n   - Fix: Review test setup/teardown, ensure clean state\n\nThese are NOT security-critical failures - core permissions system is verified secure.\n\nPriority: Medium (not blocking production deployment)","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-01T16:41:54.397873-05:00","updated_at":"2025-11-01T16:41:54.397873-05:00","labels":["bug","testing"],"dependencies":[{"issue_id":"biensperience-eee5","depends_on_id":"biensperience-ab67","type":"blocks","created_at":"2025-11-01T16:41:54.401795-05:00","created_by":"gokepelemo"}]}
{"id":"biensperience-f974","content_hash":"486bc6137e92bd03747378934638e19170af934b2b603b0df4dcca4f42e035be","title":"Implement comprehensive activity tracking for entity state changes","description":"All actions to any entity should be added to activity and reversible. Most importantly, experiences, destinations, and plans. A super admin should be able to restore a previous state of an entity's resource. Implementation requirements:\n- Track all CRUD operations on experiences, destinations, and plans\n- Store complete before/after state for reversibility\n- Implement restore functionality for super admins\n- Add UI for viewing entity history and restoring previous states\n- Ensure all Activity.create() calls are asynchronous and non-blocking\n- Use Promise.all() or background jobs for audit logging to avoid blocking responses\n","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-01T16:19:41.610243-05:00","updated_at":"2025-11-01T17:11:40.210085-05:00","closed_at":"2025-11-01T17:11:40.210085-05:00"}
{"id":"biensperience-fb36","content_hash":"951b393adb2e50d5541c8b72cd0102f87a99ded515af2c53741372436665b520","title":"Integrate session/trace IDs into logger","description":"Update backend-logger.js to include sessionId and traceId in all log entries. Extract from req.sessionId and req.traceId. Format: { sessionId: 'bien-session-id', traceId: 'bien-trace-id', ...logData }. Update all log calls to accept request object.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-01T15:15:56.091949-05:00","updated_at":"2025-11-01T15:51:29.826033-05:00","closed_at":"2025-11-01T15:51:29.826033-05:00","dependencies":[{"issue_id":"biensperience-fb36","depends_on_id":"biensperience-bb27","type":"blocks","created_at":"2025-11-01T15:15:56.095183-05:00","created_by":"gokepelemo"},{"issue_id":"biensperience-fb36","depends_on_id":"biensperience-e4ad","type":"blocks","created_at":"2025-11-01T15:15:56.096577-05:00","created_by":"gokepelemo"}]}
