/**
 * Responsive Form Styles - Accessibility & Dark Mode
 * Uses clamp() for responsive sizing at any viewport
 */

@use '../abstracts' as *;

/* ============================================
   FORM CONTAINERS
   ============================================ */

form,
.form-container {
  width: clamp(300px, 90%, 800px);
  margin: 0 auto;
  padding: clamp(var(--space-2), 2vw, var(--space-6));
}

/* Specific form classes */
form.newExperience,
form.new-experience-form,
form.update-experience-form,
form.new-destination-form,
form.update-destination-form,
form.update-profile-form,
.login-form,
.signup-form {
  width: clamp(300px, 90%, 800px);
  min-width: 300px;
  max-width: 800px;
  margin: 0 auto;
}

input[type="checkbox"] {
  margin: 0 !important;
}

/* ============================================
   FORM LABELS
   ============================================ */

.form-label,
form label,
.new-experience-form label,
.new-experience-form .form-label,
.update-experience-form label,
.update-experience-form .form-label {
  font-size: clamp(var(--font-size-sm), 2vw, var(--font-size-xl));
  font-weight: $font-weight-semibold;
  margin-bottom: clamp(var(--space-1), 1vw, var(--space-2));
  color: var(--color-text-primary);
  line-height: $line-height-snug;
}

/* ============================================
   FORM CONTROLS
   ============================================ */

.form-control,
.form-select,
input[type="text"],
input[type="email"],
input[type="password"],
input[type="number"],
input[type="date"],
input[type="url"],
textarea,
select {
  font-size: clamp(var(--font-size-sm), 1.5vw, var(--font-size-lg)) !important;
  padding: clamp(var(--space-2), 1.5vw, var(--space-3)) clamp(var(--space-3), 2vw, var(--space-5));
  min-height: clamp(2.5rem, 6vw, 3.5rem);
  line-height: $line-height-normal;
  border-radius: clamp(var(--radius-md), 1vw, var(--radius-lg));
  border: 2px solid var(--color-border-medium);
  transition: all $transition-normal;
  width: 100%;
  box-sizing: border-box;
}

/* Specific overrides for form-specific styles */
.new-experience-form .form-control,
.new-experience-form .form-select,
.update-experience-form .form-control,
.update-experience-form .form-select {
  font-size: clamp(var(--font-size-sm), 1.5vw, var(--font-size-lg)) !important;
  padding: clamp(var(--space-2), 1.5vw, var(--space-3)) clamp(var(--space-3), 2vw, var(--space-5)) !important;
  min-height: clamp(2.5rem, 6vw, 3.5rem);
}

/* Textareas - additional height consideration */
textarea.form-control {
  min-height: clamp(4rem, 10vw, 8rem);
  resize: vertical;
}

/* ============================================
   INPUT GROUPS
   ============================================ */

.input-group {
  gap: clamp(var(--space-1), 1vw, var(--space-2));
  flex-wrap: wrap; /* Allow wrapping on very small screens */
}

/* Unified input group (prefix/suffix fields like "$" or "days")
   Renders a single continuous border around the whole group. */
.input-group.input-group-unified {
  gap: 0;
  flex-wrap: nowrap;
  background: var(--color-bg-input);
  border: 2px solid var(--color-border-medium);
  border-radius: var(--radius-md);
  overflow: hidden;
  transition: all var(--transition-base);

  > .form-control,
  > .form-select {
    border: none;
    box-shadow: none !important;
    min-width: 0;
  }

  > .input-group-text {
    background: transparent;
    border: none;
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
    white-space: nowrap;
  }

  > .btn {
    border: none;
    border-radius: 0;
  }
}

.input-group .form-control,
.input-group .form-select {
  flex: 1 1 auto;
  min-width: clamp(150px, 40%, 300px);
}

.input-group-text {
  font-size: clamp(var(--font-size-xs), 1.5vw, var(--font-size-base));
  padding: clamp(var(--space-2), 1.5vw, var(--space-3)) clamp(var(--space-2), 1.5vw, var(--space-3));
  background: transparent;
  border: none;
}

.input-group .btn {
  /* Use standardized button sizing */
  min-height: var(--btn-height-md);
  padding: var(--btn-padding-y-md) var(--btn-padding-x-md);
  font-size: var(--btn-font-size-md);
  font-weight: var(--btn-font-weight);
  white-space: nowrap;
}

.new-experience-form .input-group,
.update-experience-form .input-group {
  padding: clamp(var(--space-3), 2vw, var(--space-5));
  margin-bottom: clamp(var(--space-2), 1.5vw, var(--space-4));
}

/* ============================================
   BUTTONS - Using Unified Design System
   Heights: 36px (sm), 44px (md), 52px (lg)
   ============================================ */

form button,
form .btn {
  /* Use standardized button sizing */
  min-height: var(--btn-height-md);
  padding: var(--btn-padding-y-md) var(--btn-padding-x-md);
  font-size: var(--btn-font-size-md);
  font-weight: var(--btn-font-weight);
  border-radius: var(--btn-radius-default);
  transition: var(--btn-transition);
}

/* Submit buttons - slightly wider min-width */
form button[type="submit"],
form .btn-primary {
  min-width: clamp(120px, 30%, 200px);
}

/* Button groups */
.btn-group .btn {
  min-width: clamp(80px, 20%, 120px);
}

/* Small buttons in forms */
form .btn-sm {
  min-height: var(--btn-height-sm);
  padding: var(--btn-padding-y-sm) var(--btn-padding-x-sm);
  font-size: var(--btn-font-size-sm);
}

/* Large buttons in forms */
form .btn-lg {
  min-height: var(--btn-height-lg);
  padding: var(--btn-padding-y-lg) var(--btn-padding-x-lg);
  font-size: var(--btn-font-size-lg);
}

/* ============================================
   HELPER TEXT & VALIDATION
   ============================================ */

.form-text,
small.form-text {
  font-size: clamp(var(--font-size-xs), 1.25vw, var(--font-size-sm));
  margin-top: clamp(var(--space-1), 0.5vw, var(--space-2));
  display: block;
  line-height: 1.4;
}

.invalid-feedback,
.valid-feedback {
  font-size: clamp(var(--font-size-xs), 1.25vw, var(--font-size-sm));
  margin-top: clamp(var(--space-1), 0.5vw, var(--space-2));
  display: block;
}

/* ============================================
   FORM GROUPS & SPACING
   ============================================ */

.form-group,
.mb-3,
.mb-4 {
  margin-bottom: clamp(var(--space-3), 2vw, var(--space-6)) !important;
}

.row {
  row-gap: clamp(var(--space-3), 2vw, var(--space-4));
}

/* ============================================
   FOCUS STATES
   ============================================ */

.form-control:focus,
.form-select:focus,
.input-group:focus-within {
  border-color: var(--color-primary);
  box-shadow: $shadow-sm;
  outline: none;
}

/* High contrast focus for accessibility */
@media (prefers-contrast: high) {
  .form-control:focus,
  .form-select:focus {
    outline: 3px solid currentColor;
    outline-offset: 2px;
  }
}

/* ============================================
   CHECKBOX AND RADIO BUTTONS
   ============================================ */

.form-check {
  padding-left: 0;
  margin-bottom: $space-4;
}

.form-check-input {
  margin-right: $space-3;
  margin-top: $space-1;
  float: left;
}

.form-check-label {
  display: inline-block;
  padding-left: 0;
  margin-left: 2rem;
}

.form-check .form-check-input + .form-check-label {
  margin-left: 0;
  padding-left: $space-2;
}

/* ============================================
   RESPONSIVE BREAKPOINTS
   ============================================ */

/* Mobile Overrides (< 576px) */
@include breakpoint-max(sm) {
  form,
  .form-container,
  form.newExperience,
  form.new-experience-form,
  form.update-experience-form {
    width: 95%;
    min-width: 280px;
    padding: $space-3;
  }

  /* Auth forms: keep input groups inline on mobile */
  .login-form .input-group,
  .signup-form .input-group,
  [class*="authCard"] .input-group {
    flex-direction: row;
    flex-wrap: nowrap;

    .form-control {
      width: auto;
      min-width: 0;
      flex: 1;
    }

    .input-group-text {
      width: auto;
      min-width: auto;
    }

    .btn {
      width: auto;
      min-width: auto;
    }
  }

  /* Non-auth input groups: stack on mobile */
  .input-group:not(.login-form .input-group):not(.signup-form .input-group):not([class*="authCard"] .input-group) {
    flex-direction: column;
  }

  /* Unified prefix/suffix groups should stay inline even on mobile */
  .input-group.input-group-unified {
    flex-direction: row;
    flex-wrap: nowrap;
  }

  .input-group:not(.login-form .input-group):not(.signup-form .input-group):not([class*="authCard"] .input-group) .form-control,
  .input-group:not(.login-form .input-group):not(.signup-form .input-group):not([class*="authCard"] .input-group) .btn {
    width: 100%;
    min-width: 100%;
  }

  form button,
  form .btn {
    width: 100%;
    max-width: 100%;
    /* Maintain standardized height on mobile */
    min-height: var(--btn-height-md);
  }

  .form-label,
  form label {
    font-size: $font-size-sm;
  }
}

/* Tablet Overrides (576px - 991px) */
@media (min-width: 576px) and (max-width: 991.98px) {
  form,
  .form-container {
    width: 85%;
  }
}

/* Desktop Overrides (>= 992px) */
@media (min-width: 992px) {
  form,
  .form-container {
    width: 75%;
    max-width: 800px;
  }

  .input-group {
    flex-wrap: nowrap;
  }
}

/* ============================================
   REDUCED MOTION SUPPORT
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  .form-control,
  .form-select,
  .btn,
  .input-group {
    transition: none;
  }
}
